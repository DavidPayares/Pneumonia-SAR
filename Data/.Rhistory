residuals.sarlm(neu.lag.sm.11)
coef.sarlm(neu.lag.sm.11)
fitted.sarlm(neu.lag.sm.11)
bptest.sarlm(neu.lag.sm.11)
hetero.plot <- function(model) {
plot(residuals(model) ~ fitted(model))
abline(h=0, lty="dotted")
lines(lowess(fitted(model), residuals(model)), col="red")
}
hetero.plot(neu.lag.sm.11)
NK(neu.lag.sm.11, neu.poly.11$SMR11)
shapiro.test(neu.lag.sm.11$residuals)
# Modelo Spatial Error:
neu.error.sm.11 <- errorsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11)
summary(neu.error.sm.11, correlation=TRUE, Nagelkerke=T)
NK(neu.error.sm.11,neu.poly.11$SMR11)
predict.sarlm(neu.error.sm.11)
AIC(neu.error.sm.11)
deviance.sarlm(neu.error.sm.11)
residuals.sarlm(neu.error.sm.11)
coef.sarlm(neu.error.sm.11)
fitted.sarlm(neu.error.sm.11)
bptest.sarlm(neu.error.sm.11)
hetero.plot(neu.error.sm.11)
shapiro.test(neu.error.sm.11$residuals)
# Durbin spatial
neu.dur.sm.11<-lagsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, type="mixed")
summary(neu.dur.sm.11, correlation=TRUE)
predict.sarlm(neu.dur.sm.11)
AIC(neu.dur.sm.11)
deviance.sarlm(neu.dur.sm.11)
residuals.sarlm(neu.dur.sm.11)
coef.sarlm(neu.dur.sm.11)
fitted.sarlm(neu.dur.sm.11)
bptest.sarlm(neu.dur.sm.11)
shapiro.test(neu.dur.sm.11$residuals)
###SARAR
neu.sarar.sm.11 <- sacsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, method="eigen")
summary(neu.sarar.sm.11, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.11)
AIC(neu.sarar.sm.11)
deviance.sarlm(neu.sarar.sm.11)
residuals.sarlm(neu.sarar.sm.11)
coef.sarlm(neu.sarar.sm.11)
fitted.sarlm(neu.sarar.sm.11)
bptest.sarlm(neu.sarar.sm.11)
hetero.plot(neu.lag.sm.11)
shapiro.test(neu.sarar.sm.11$residuals)
##Spatial Durbin error Model
neu.errorM.sm.11 <- errorsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, etype = "emixed")
summary(neu.errorM.sm.11, correlation=TRUE, Nagelkerke=T)
NK(neu.errorM.sm.11,neu.poly.11$SMR11)
predict.sarlm(neu.errorM.sm.11)
AIC(neu.errorM.sm.11)
deviance.sarlm(neu.errorM.sm.11)
residuals.sarlm(neu.errorM.sm.11)
coef.sarlm(neu.errorM.sm.11)
fitted.sarlm(neu.errorM.sm.11)
bptest.sarlm(neu.errorM.sm.11)
hetero.plot(neu.errorM.sm.11)
##General Nesting Spatial Model
neu.gns.sm.11 <- sacsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, type="sacmixed")
summary(neu.gns.sm.11, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.11)
AIC(neu.gns.sm.11)
deviance.sarlm(neu.gns.sm.11)
residuals.sarlm(neu.gns.sm.11)
coef.sarlm(neu.gns.sm.11)
fitted.sarlm(neu.gns.sm.11)
bptest.sarlm(neu.gns.sm.11)
hetero.plot(neu.lag.sm.11)
shapiro.test(neu.gns.sm.11$residuals)
### Spatial lag of X
neu.slx.sm.11 <-lm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11 +  WCVD11 + WVAC11  , data=as.data.frame(neu.poly.11))
summary(neu.slx.sm.11)
NK(neu.slx.sm.11,neu.poly.11$SMR11)
predict(neu.slx.sm.11)
AIC(neu.slx.sm.11)
deviance(neu.slx.sm.11)
residuals(neu.slx.sm.11)
coef(neu.slx.sm.11)
fitted(neu.slx.sm.11)
bptest(neu.slx.sm.11)
hetero.plot(neu.slx.sm.11)
# Comparacisn
anova(neu.lag.sm.11,neu.error.sm.11,neu.dur.sm.11,neu.sarar.sm.11, neu.errorM.sm.11, neu.gns.sm.11 , neu.slx.sm.11)
#######2014
neu.poly.14$WIPSE14 <- lag.listw(kn2.lw.14, neu.poly.14$IPSE14)
neu.poly.14$WCVV14 <- lag.listw(kn2.lw.14, neu.poly.14$CVV14)
neu.poly.14$WVAC14 <- lag.listw(kn2.lw.14, neu.poly.14$VAC14)
neu.poly.14$WTEM14 <- lag.listw(kn2.lw.14, neu.poly.14$TEM14)
neu.poly.14$WCPM14 <- lag.listw(kn2.lw.14, neu.poly.14$CPM14)
neu.poly.14$WNUT14 <- lag.listw(kn2.lw.14, neu.poly.14$NUT14)
neu.poly.14$WIDD14 <- lag.listw(kn2.lw.14, neu.poly.14$IDD14)
neu.poly.14$WESC14 <- lag.listw(kn2.lw.14, neu.poly.14$ESC14)
neu.poly.14$WY <- lag.listw(kn2.lw.14, neu.poly.14$SMR14)
#### SPATIAL-LAG  #####
neu.lag.sm.14 <- lagsarlm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14, data=as.data.frame(neu.poly.14), kn2.lw.14, method="eigen")
summary(neu.lag.sm.14, Nagelkerke=T, correlation=TRUE)
predict.sarlm(neu.lag.sm.14)
AIC(neu.lag.sm.14)
deviance.sarlm(neu.lag.sm.14)
residuals.sarlm(neu.lag.sm.14)
coef.sarlm(neu.lag.sm.14)
fitted.sarlm(neu.lag.sm.14)
bptest.sarlm(neu.lag.sm.14)
hetero.plot <- function(model) {
plot(residuals(model) ~ fitted(model))
abline(h=0, lty="dotted")
lines(lowess(fitted(model), residuals(model)), col="red")
}
hetero.plot(neu.lag.sm.14)
NK(neu.lag.sm.14, neu.poly.14$SMR14)
shapiro.test(neu.lag.sm.14$residuals)
# Modelo Spatial Error:
neu.error.sm.14 <- errorsarlm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14, data=as.data.frame(neu.poly.14), kn2.lw.14)
summary(neu.error.sm.14, correlation=TRUE, Nagelkerke=T)
NK(neu.error.sm.14,neu.poly.14$SMR14)
predict.sarlm(neu.error.sm.14)
AIC(neu.error.sm.14)
deviance.sarlm(neu.error.sm.14)
residuals.sarlm(neu.error.sm.14)
coef.sarlm(neu.error.sm.14)
fitted.sarlm(neu.error.sm.14)
bptest.sarlm(neu.error.sm.14)
hetero.plot(neu.error.sm.14)
shapiro.test(neu.error.sm.14$residuals)
# Durbin spatial
neu.dur.sm.14<-lagsarlm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14, data=as.data.frame(neu.poly.14), kn2.lw.14, type="mixed")
summary(neu.dur.sm.14, correlation=TRUE)
predict.sarlm(neu.dur.sm.14)
AIC(neu.dur.sm.14)
deviance.sarlm(neu.dur.sm.14)
residuals.sarlm(neu.dur.sm.14)
coef.sarlm(neu.dur.sm.14)
fitted.sarlm(neu.dur.sm.14)
bptest.sarlm(neu.dur.sm.14)
shapiro.test(neu.dur.sm.14$residuals)
###SARAR
neu.sarar.sm.14 <- sacsarlm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14, data=as.data.frame(neu.poly.14), kn2.lw.14, method="eigen")
summary(neu.sarar.sm.14, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.14)
AIC(neu.sarar.sm.14)
deviance.sarlm(neu.sarar.sm.14)
residuals.sarlm(neu.sarar.sm.14)
coef.sarlm(neu.sarar.sm.14)
fitted.sarlm(neu.sarar.sm.14)
bptest.sarlm(neu.sarar.sm.14)
hetero.plot(neu.lag.sm.14)
shapiro.test(neu.sarar.sm.14$residuals)
##Spatial Durbin error Model
neu.errorM.sm.14 <- errorsarlm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14, data=as.data.frame(neu.poly.14), kn2.lw.14, etype = "emixed")
summary(neu.errorM.sm.14, correlation=TRUE, Nagelkerke=T)
NK(neu.errorM.sm.14,neu.poly.14$SMR14)
predict.sarlm(neu.errorM.sm.14)
AIC(neu.errorM.sm.14)
deviance.sarlm(neu.errorM.sm.14)
residuals.sarlm(neu.errorM.sm.14)
coef.sarlm(neu.errorM.sm.14)
fitted.sarlm(neu.errorM.sm.14)
bptest.sarlm(neu.errorM.sm.14)
hetero.plot(neu.errorM.sm.14)
##General Nesting Spatial Model
neu.gns.sm.14 <- sacsarlm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14, data=as.data.frame(neu.poly.14), kn2.lw.14, type="sacmixed")
### neu.gns.sm.14 <- sacsarlm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14 + WIPSE14 + WCVV14 + WVAC14 + WESC14, data=as.data.frame(neu.poly.14), kn2.lw.14)  ##es lo mismo que escribir "sacmixed"
summary(neu.gns.sm.14, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.14)
AIC(neu.gns.sm.14)
deviance.sarlm(neu.gns.sm.14)
residuals.sarlm(neu.gns.sm.14)
coef.sarlm(neu.gns.sm.14)
fitted.sarlm(neu.gns.sm.14)
bptest.sarlm(neu.gns.sm.14)
hetero.plot(neu.lag.sm.14)
shapiro.test(neu.gns.sm.14$residuals)
### Spatial lag of X
neu.slx.sm.14 <-lm(SMR14 ~ IPSE14 + CVV14 + VAC14 + ESC14 + WESC14 + WIPSE14 + WCVV14 + WVAC14, data=as.data.frame(neu.poly.14))
summary(neu.slx.sm.14)
NK(neu.slx.sm.14,neu.poly.14$SMR14)
predict(neu.slx.sm.14)
AIC(neu.slx.sm.14)
deviance(neu.slx.sm.14)
residuals(neu.slx.sm.14)
coef(neu.slx.sm.14)
fitted(neu.slx.sm.14)
bptest(neu.slx.sm.14)
hetero.plot(neu.slx.sm.14)
anova(neu.lag.sm.14,neu.error.sm.14,neu.dur.sm.14,neu.sarar.sm.14, neu.errorM.sm.14, neu.gns.sm.14,neu.slx.sm.14)
anova(neu.lag.sm.04,neu.error.sm.04,neu.dur.sm.04,neu.sarar.sm.04, neu.errorM.sm.04, neu.gns.sm.14,neu.slx.sm.04)
# Modelo Spatial Lag:
neu.lag.sm.04 <- lagsarlm(SMR04 ~ ESC04 + TEM04 + W3SMR , data=as.data.frame(neu.poly.04), listw=a.lw.04, method="eigen")
summary(neu.lag.sm.04, Nagelkerke=T, correlation=TRUE)
predict.sarlm(neu.lag.sm.04)
AIC(neu.lag.sm.04)
deviance.sarlm(neu.lag.sm.04)
residuals.sarlm(neu.lag.sm.04)
coef.sarlm(neu.lag.sm.04)
fitted.sarlm(neu.lag.sm.04)
bptest.sarlm(neu.lag.sm.04)
hetero.plot(neu.lag.sm.04)
NK(neu.lag.sm.04, neu.poly.04$SMR04)
shapiro.test(neu.lag.sm.04$residuals)
# Modelo Spatial Error:
neu.error.sm.04 <- errorsarlm(SMR04 ~ ESC04 + TEM04 + W3SMR, data=as.data.frame(neu.poly.04), listw=a.lw.04)
summary(neu.error.sm.04, correlation=TRUE, Nagelkerke=T)
NK(neu.error.sm.04,neu.poly.04$SMR04)
predict.sarlm(neu.error.sm.04)
AIC(neu.error.sm.04)
deviance.sarlm(neu.error.sm.04)
residuals.sarlm(neu.error.sm.04)
coef.sarlm(neu.error.sm.04)
fitted.sarlm(neu.error.sm.04)
bptest.sarlm(neu.error.sm.04)
hetero.plot(neu.error.sm.04)
shapiro.test(neu.error.sm.04$residuals)
#Modelo Durbin spatial:
neu.dur.sm.04<-lagsarlm(SMR04 ~ ESC04 + TEM04 +  WESC04 + WTEM04 + W3SMR, data=as.data.frame(neu.poly.04), listw=a.lw.04)
summary(neu.dur.sm.04, correlation=TRUE)
predict.sarlm(neu.dur.sm.04)
AIC(neu.dur.sm.04)
deviance.sarlm(neu.dur.sm.04)
residuals.sarlm(neu.dur.sm.04)
coef.sarlm(neu.dur.sm.04)
fitted.sarlm(neu.dur.sm.04)
bptest.sarlm(neu.dur.sm.04)
shapiro.test(neu.dur.sm.04$residuals)
NK(neu.dur.sm.04, neu.poly.04$SMR04)
###SARAR
neu.sarar.sm.04 <- sacsarlm(SMR04 ~ ESC04 + TEM04 + W3SMR, data=as.data.frame(neu.poly.04), listw=a.lw.04, method="eigen")
summary(neu.sarar.sm.04, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.04)
AIC(neu.sarar.sm.04)
deviance.sarlm(neu.sarar.sm.04)
residuals.sarlm(neu.sarar.sm.04)
coef.sarlm(neu.sarar.sm.04)
fitted.sarlm(neu.sarar.sm.04)
bptest.sarlm(neu.sarar.sm.04)
hetero.plot(neu.lag.sm.04)
shapiro.test(neu.sarar.sm.04$residuals)
##Spatial Durbin error Model
neu.errorM.sm.04 <- errorsarlm(SMR04 ~ ESC04 + TEM04 +  WESC04 + WTEM04 + W3SMR, data=as.data.frame(neu.poly.04), listw=a.lw.04)
summary(neu.errorM.sm.04, correlation=TRUE, Nagelkerke=T)
NK(neu.errorM.sm.04,neu.poly.04$SMR04)
predict.sarlm(neu.errorM.sm.04)
AIC(neu.errorM.sm.04)
deviance.sarlm(neu.errorM.sm.04)
residuals.sarlm(neu.errorM.sm.04)
coef.sarlm(neu.errorM.sm.04)
fitted.sarlm(neu.errorM.sm.04)
bptest.sarlm(neu.errorM.sm.04)
hetero.plot(neu.errorM.sm.04)
##General Nesting Spatial Model
neu.gns.sm.04 <- sacsarlm(SMR04 ~ ESC04 + TEM04 +  WESC04 + WTEM04 + W3SMR, data=as.data.frame(neu.poly.04), listw=a.lw.04)
summary(neu.gns.sm.04, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.04)
AIC(neu.gns.sm.04)
deviance.sarlm(neu.gns.sm.04)
residuals.sarlm(neu.gns.sm.04)
coef.sarlm(neu.gns.sm.04)
fitted.sarlm(neu.gns.sm.04)
bptest.sarlm(neu.gns.sm.04)
hetero.plot(neu.lag.sm.04)
shapiro.test(neu.gns.sm.04$residuals)
### Spatial lag of X
neu.slx.sm.04 <-lm(SMR04 ~ ESC04 + TEM04 +  WESC04 + WTEM04 + W3SMR, data=as.data.frame(neu.poly.04))
summary(neu.slx.sm.04)
NK(neu.slx.sm.04,neu.poly.04$SMR04)
predict(neu.slx.sm.04)
AIC(neu.slx.sm.04)
deviance(neu.slx.sm.04)
residuals(neu.slx.sm.04)
coef(neu.slx.sm.04)
fitted(neu.slx.sm.04)
bptest(neu.slx.sm.04)
hetero.plot(neu.slx.sm.04)
# Comparacisn
anova(neu.lag.sm.04,neu.error.sm.04,neu.dur.sm.04,neu.sarar.sm.04, neu.errorM.sm.04, neu.gns.sm.04, neu.slx.sm.04)
neu.poly.07$WESC07 <- lag.listw(kn1.lw.07, log(neu.poly.07$ESC07))
neu.poly.07$WDEP07 <- lag.listw(kn1.lw.07, log(neu.poly.07$DEP07))
neu.poly.07$WIPSE07 <- lag.listw(kn1.lw.07, log(neu.poly.07$IPSE07))
neu.poly.07$WVAC07 <- lag.listw(kn1.lw.07, log(neu.poly.07$VAC07))
neu.poly.07$WTEM07 <- lag.listw(kn1.lw.07, log(neu.poly.07$TEM07))
neu.poly.07$WY <- lag.listw(kn1.lw.07, neu.poly.07$SMR07)
neu.lag.sm.07 <- lagsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07) + log(VAC07) , data=as.data.frame(neu.poly.07), listw=kn1.lw.07, method="eigen")
summary(neu.lag.sm.07, Nagelkerke=T, correlation=TRUE)
predict.sarlm(neu.lag.sm.07)
AIC(neu.lag.sm.07)
# Comparacisn
anova(neu.lag.sm.04,neu.error.sm.04,neu.dur.sm.04,neu.sarar.sm.04, neu.errorM.sm.04, neu.gns.sm.04, neu.slx.sm.04)
neu.poly.07$WESC07 <- lag.listw(kn1.lw.07, log(neu.poly.07$ESC07))
neu.poly.07$WDEP07 <- lag.listw(kn1.lw.07, log(neu.poly.07$DEP07))
neu.poly.07$WIPSE07 <- lag.listw(kn1.lw.07, log(neu.poly.07$IPSE07))
neu.poly.07$WVAC07 <- lag.listw(kn1.lw.07, log(neu.poly.07$VAC07))
neu.poly.07$WTEM07 <- lag.listw(kn1.lw.07, log(neu.poly.07$TEM07))
neu.poly.07$WY <- lag.listw(kn1.lw.07, neu.poly.07$SMR07)
#### SPATIAL-LAG  #####
neu.lag.sm.07 <- lagsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07) + log(VAC07) , data=as.data.frame(neu.poly.07), listw=kn1.lw.07, method="eigen")
summary(neu.lag.sm.07, Nagelkerke=T, correlation=TRUE)
predict.sarlm(neu.lag.sm.07)
AIC(neu.lag.sm.07)
deviance.sarlm(neu.lag.sm.07)
residuals.sarlm(neu.lag.sm.07)
coef.sarlm(neu.lag.sm.07)
fitted.sarlm(neu.lag.sm.07)
bptest.sarlm(neu.lag.sm.07)
hetero.plot <- function(model) {
plot(residuals(model) ~ fitted(model))
abline(h=0, lty="dotted")
lines(lowess(fitted(model), residuals(model)), col="red")
}
hetero.plot(neu.lag.sm.07)
NK(neu.lag.sm.07, neu.poly.07$SMR07)
shapiro.test(neu.lag.sm.07$residuals)
# Modelo Spatial Error:
neu.error.sm.07 <- errorsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07) + log(VAC07) , data=as.data.frame(neu.poly.07), listw=kn1.lw.07)
summary(neu.error.sm.07, correlation=TRUE, Nagelkerke=T)
NK(neu.error.sm.07,neu.poly.07$SMR07)
predict.sarlm(neu.error.sm.07)
AIC(neu.error.sm.07)
deviance.sarlm(neu.error.sm.07)
residuals.sarlm(neu.error.sm.07)
coef.sarlm(neu.error.sm.07)
fitted.sarlm(neu.error.sm.07)
bptest.sarlm(neu.error.sm.07)
hetero.plot(neu.error.sm.07)
shapiro.test(neu.error.sm.07$residuals)
# Durbin spatial
neu.dur.sm.07<-lagsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07)  + log(VAC07) , data=as.data.frame(neu.poly.07), listw=kn1.lw.07, type="mixed")
summary(neu.dur.sm.07, correlation=TRUE)
predict.sarlm(neu.dur.sm.07)
AIC(neu.dur.sm.07)
deviance.sarlm(neu.dur.sm.07)
residuals.sarlm(neu.dur.sm.07)
coef.sarlm(neu.dur.sm.07)
fitted.sarlm(neu.dur.sm.07)
bptest.sarlm(neu.dur.sm.07)
shapiro.test(neu.dur.sm.07$residuals)
###SARAR
neu.sarar.sm.07 <- sacsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07)  + log(VAC07) , data=as.data.frame(neu.poly.07), listw=kn1.lw.07, method="eigen")
summary(neu.sarar.sm.07, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.07)
AIC(neu.sarar.sm.07)
deviance.sarlm(neu.sarar.sm.07)
residuals.sarlm(neu.sarar.sm.07)
coef.sarlm(neu.sarar.sm.07)
fitted.sarlm(neu.sarar.sm.07)
bptest.sarlm(neu.sarar.sm.07)
hetero.plot(neu.lag.sm.07)
shapiro.test(neu.sarar.sm.07$residuals)
##Spatial Durbin error Model
neu.errorM.sm.07 <- errorsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07) + log(VAC07), data=as.data.frame(neu.poly.07), listw=kn1.lw.07 , etype = "emixed")
summary(neu.errorM.sm.07, correlation=TRUE, Nagelkerke=T)
NK(neu.errorM.sm.07,neu.poly.07$SMR07)
predict.sarlm(neu.errorM.sm.07)
AIC(neu.errorM.sm.07)
deviance.sarlm(neu.errorM.sm.07)
residuals.sarlm(neu.errorM.sm.07)
coef.sarlm(neu.errorM.sm.07)
fitted.sarlm(neu.errorM.sm.07)
bptest.sarlm(neu.errorM.sm.07)
hetero.plot(neu.errorM.sm.07)
neu.poly.07$VAC07
##General Nesting Spatial Model
neu.gns.sm.07 <- sacsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07) + log(VAC07), data=as.data.frame(neu.poly.07), listw=kn1.lw.07, type="sacmixed")
###neu.gns.sm.07 <- sacsarlm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07) + log(VAC07) + WESC07 + WDEP07 + WIPSE07 + WVAC07, data=as.data.frame(neu.poly.07), listw=kn1.lw.07)  ##Lo mismo pero sin la clausula sacmixed.
summary(neu.gns.sm.07, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.07)
AIC(neu.gns.sm.07)
deviance.sarlm(neu.gns.sm.07)
residuals.sarlm(neu.gns.sm.07)
coef.sarlm(neu.gns.sm.07)
fitted.sarlm(neu.gns.sm.07)
bptest.sarlm(neu.gns.sm.07)
hetero.plot(neu.lag.sm.07)
shapiro.test(neu.gns.sm.07$residuals)
### Spatial lag of X
neu.slx.sm.07 <-lm(SMR07 ~ log(ESC07) + log(DEP07) + log(IPSE07) + log(VAC07) + WESC07 + WDEP07 + WIPSE07 + WVAC07, data=as.data.frame(neu.poly.07))
summary(neu.slx.sm.07)
NK(neu.slx.sm.07,neu.poly.07$SMR07)
predict(neu.slx.sm.07)
AIC(neu.slx.sm.07)
deviance(neu.slx.sm.07)
residuals(neu.slx.sm.07)
coef(neu.slx.sm.07)
fitted(neu.slx.sm.07)
bptest(neu.slx.sm.07)
hetero.plot(neu.slx.sm.07)
# Comparacisn
anova(neu.lag.sm.07,neu.error.sm.07,neu.dur.sm.07,neu.sarar.sm.07, neu.errorM.sm.07, neu.gns.sm.07,neu.slx.sm.07)
# Comparacisn
anova(neu.lag.sm.04,neu.error.sm.04,neu.dur.sm.04,neu.sarar.sm.04, neu.errorM.sm.04, neu.gns.sm.04, neu.slx.sm.04)
triang.lags.11 <- nblag(triang.11,3)
t1.lw.11.1 <- nb2listw(triang.lags.11[[1]], style="W")
t1.lw.11.3 <- nb2listw(triang.lags.11[[3]], style="W")
neu.poly.11$WCVD11 <- lag.listw(t1.lw.11, neu.poly.11$CVD11)
neu.poly.11$WVAC11 <- lag.listw(t1.lw.11, neu.poly.11$VAC11)
neu.poly.11$WCVV11 <- lag.listw(t1.lw.11, neu.poly.11$CVV11)
neu.poly.11$WIPSE11 <- lag.listw(t1.lw.11, neu.poly.11$IPSE11)
neu.poly.11$wCPM11  <- lag.listw(t1.lw.11, neu.poly.11$CPM11)
neu.poly.11$W1SRM <- lag.listw(t1.lw.11.1, neu.poly.11$SMR11)    ###No es significativa para ningun modelo
neu.poly.11$W3SRM <- lag.listw(t1.lw.11.3, neu.poly.11$SMR11)    ###No es significativa para ningun modelo
neu.poly.11$WY <- lag.listw(t1.lw.11, powerTransforma(neu.poly.11$SMR11,lambda.11))
#### SPATIAL-LAG  #####
neu.lag.sm.11 <- lagsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11 + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, method="eigen")
summary(neu.lag.sm.11, Nagelkerke=T, correlation=TRUE)
predict.sarlm(neu.lag.sm.11)
AIC(neu.lag.sm.11)
deviance.sarlm(neu.lag.sm.11)
residuals.sarlm(neu.lag.sm.11)
coef.sarlm(neu.lag.sm.11)
fitted.sarlm(neu.lag.sm.11)
bptest.sarlm(neu.lag.sm.11)
hetero.plot <- function(model) {
plot(residuals(model) ~ fitted(model))
abline(h=0, lty="dotted")
lines(lowess(fitted(model), residuals(model)), col="red")
}
hetero.plot(neu.lag.sm.11)
NK(neu.lag.sm.11, neu.poly.11$SMR11)
shapiro.test(neu.lag.sm.11$residuals)
# Modelo Spatial Error:
neu.error.sm.11 <- errorsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11)
summary(neu.error.sm.11, correlation=TRUE, Nagelkerke=T)
NK(neu.error.sm.11,neu.poly.11$SMR11)
predict.sarlm(neu.error.sm.11)
AIC(neu.error.sm.11)
deviance.sarlm(neu.error.sm.11)
residuals.sarlm(neu.error.sm.11)
coef.sarlm(neu.error.sm.11)
fitted.sarlm(neu.error.sm.11)
bptest.sarlm(neu.error.sm.11)
hetero.plot(neu.error.sm.11)
shapiro.test(neu.error.sm.11$residuals)
# Durbin spatial
neu.dur.sm.11<-lagsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, type="mixed")
summary(neu.dur.sm.11, correlation=TRUE)
predict.sarlm(neu.dur.sm.11)
AIC(neu.dur.sm.11)
deviance.sarlm(neu.dur.sm.11)
residuals.sarlm(neu.dur.sm.11)
coef.sarlm(neu.dur.sm.11)
fitted.sarlm(neu.dur.sm.11)
bptest.sarlm(neu.dur.sm.11)
shapiro.test(neu.dur.sm.11$residuals)
###SARAR
neu.sarar.sm.11 <- sacsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, method="eigen")
summary(neu.sarar.sm.11, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.11)
AIC(neu.sarar.sm.11)
deviance.sarlm(neu.sarar.sm.11)
residuals.sarlm(neu.sarar.sm.11)
coef.sarlm(neu.sarar.sm.11)
fitted.sarlm(neu.sarar.sm.11)
bptest.sarlm(neu.sarar.sm.11)
hetero.plot(neu.lag.sm.11)
shapiro.test(neu.sarar.sm.11$residuals)
##Spatial Durbin error Model
neu.errorM.sm.11 <- errorsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, etype = "emixed")
summary(neu.errorM.sm.11, correlation=TRUE, Nagelkerke=T)
NK(neu.errorM.sm.11,neu.poly.11$SMR11)
predict.sarlm(neu.errorM.sm.11)
AIC(neu.errorM.sm.11)
deviance.sarlm(neu.errorM.sm.11)
residuals.sarlm(neu.errorM.sm.11)
coef.sarlm(neu.errorM.sm.11)
fitted.sarlm(neu.errorM.sm.11)
bptest.sarlm(neu.errorM.sm.11)
hetero.plot(neu.errorM.sm.11)
##General Nesting Spatial Model
neu.gns.sm.11 <- sacsarlm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11, data=as.data.frame(neu.poly.11), t1.lw.11, type="sacmixed")
summary(neu.gns.sm.11, correlation=TRUE, Nagelkerke=T)
predict.sarlm(neu.lag.sm.11)
AIC(neu.gns.sm.11)
deviance.sarlm(neu.gns.sm.11)
residuals.sarlm(neu.gns.sm.11)
coef.sarlm(neu.gns.sm.11)
fitted.sarlm(neu.gns.sm.11)
bptest.sarlm(neu.gns.sm.11)
hetero.plot(neu.lag.sm.11)
shapiro.test(neu.gns.sm.11$residuals)
### Spatial lag of X
neu.slx.sm.11 <-lm(powerTransforma(SMR11, lambda.11) ~ CVD11  + VAC11 +  WCVD11 + WVAC11  , data=as.data.frame(neu.poly.11))
summary(neu.slx.sm.11)
NK(neu.slx.sm.11,neu.poly.11$SMR11)
predict(neu.slx.sm.11)
AIC(neu.slx.sm.11)
deviance(neu.slx.sm.11)
residuals(neu.slx.sm.11)
coef(neu.slx.sm.11)
fitted(neu.slx.sm.11)
bptest(neu.slx.sm.11)
hetero.plot(neu.slx.sm.11)
# Comparacisn
anova(neu.lag.sm.11,neu.error.sm.11,neu.dur.sm.11,neu.sarar.sm.11, neu.errorM.sm.11, neu.gns.sm.11 , neu.slx.sm.11)
anova(neu.lag.sm.04,neu.error.sm.04,neu.dur.sm.04,neu.sarar.sm.04, neu.errorM.sm.04, neu.gns.sm.14,neu.slx.sm.04)
anova(neu.lag.sm.04,neu.error.sm.04,neu.dur.sm.04,neu.sarar.sm.04, neu.errorM.sm.04, neu.gns.sm.14,neu.slx.sm.04)
anova(neu.lag.sm.07,neu.error.sm.07,neu.dur.sm.07,neu.sarar.sm.07, neu.errorM.sm.07, neu.gns.sm.14,neu.slx.sm.07)
anova(neu.lag.sm.11,neu.error.sm.11,neu.dur.sm.11,neu.sarar.sm.11, neu.errorM.sm.11, neu.gns.sm.14,neu.slx.sm.11)
anova(neu.lag.sm.14,neu.error.sm.14,neu.dur.sm.14,neu.sarar.sm.14, neu.errorM.sm.14, neu.gns.sm.14,neu.slx.sm.14)
### 2007  ####
impacts(neu.sar.sm.07, listw=kn1.lw.07)
### 2007  ####
impacts(neu.lag.sm.07, listw=kn1.lw.07)
### 2004 ##
impacts(neu.sarar.sm.04, listw=a.lw.04)
### 2007  ####
impacts(neu.lag.sm.07, listw=kn1.lw.07)
impacts(neu.lag.sm.11, listw = t1.lw.11)
###2014###
impacts(neu.sdem.sm.14, listw = kn2.lw.14)
###2014###
impacts(neu.errorM.sm.14, listw = kn2.lw.14)
